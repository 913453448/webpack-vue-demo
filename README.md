## å‰è¨€

æˆ‘ä»¬å‰é¢ä»å‰ç«¯æ¶æ„ï¼š

- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹ï¼ˆè£…é¥°å™¨Decoratorï¼‰](https://vvbug.blog.csdn.net/article/details/106750486)
- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹ï¼ˆvue-class-componentï¼‰](https://vvbug.blog.csdn.net/article/details/106753517)
- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹(vue-property-decorator)](https://vvbug.blog.csdn.net/article/details/106758835)
- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹ï¼ˆmvcï¼‰](https://vvbug.blog.csdn.net/article/details/106785159)
- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹ï¼ˆmvpï¼‰](https://vvbug.blog.csdn.net/article/details/106789768)
- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹ï¼ˆmvvmï¼‰](https://vvbug.blog.csdn.net/article/details/106796122)

åˆ°é¡¹ç›®å·¥ç¨‹åŒ–å·¥å…·eslintã€babelã€webpackç­‰ï¼Œåˆ†åˆ«ç»“åˆdemoè·Ÿæºç åšäº†å…·ä½“çš„åˆ†æï¼š

- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹ï¼ˆeslintæºç è§£æï¼‰](https://vvbug.blog.csdn.net/article/details/106928901)
- [å‰ç«¯æ¡†æ¶ç³»åˆ—ä¹‹ï¼ˆeslintè‡ªå®šä¹‰æ’ä»¶ï¼‰](https://vvbug.blog.csdn.net/article/details/106949203)
- [babeä»å…¥é—¨åˆ°ç²¾é€š](https://vvbug.blog.csdn.net/article/details/107092536)
- ...
- [webpackæºç è§£æä¸ƒï¼ˆoptimizationï¼‰](https://vvbug.blog.csdn.net/article/details/107549955)

æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠå‰é¢çš„æ‰€æœ‰çŸ¥è¯†ç‚¹æ¥å®æˆ˜ä¸€ä¸‹ï¼Œå°±å½“æˆå‰é¢æ‰€æœ‰çŸ¥è¯†ç‚¹çš„ä¸€ä¸ªæ€»ç»“äº†ã€‚

## éœ€æ±‚

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå½“æˆ‘ä»¬ç”¨reactå¼€å‘ä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®˜æ–¹çš„è„šæ‰‹æ¶[Create React App](https://github.com/facebookincubator/create-react-app)ï¼Œå½“æˆ‘ä»¬ç”¨vueå¼€å‘ä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å®˜æ–¹çš„è„šæ‰‹æ¶[vue-cli](https://github.com/vuejs/vue-cli), ç”¨èµ·æ¥æ˜¯çœŸçš„çˆ½å•Šï¼ä¹Ÿä¸éœ€è¦è‡ªå·±å»é…ç½®eslintã€babelã€webpackç­‰ç­‰ï¼Œè„šæ‰‹æ¶ä¼šæ ¹æ®ä½ çš„é€‰æ‹©è‡ªåŠ¨å¸®ä½ å®Œæˆé…ç½®ï¼Œæ˜¯çš„ï¼ ä¸€èˆ¬é¡¹ç›®éƒ½å¯ä»¥è¦†ç›–åˆ°ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦ç”¨å¥½è¿™äº›è„šæ‰‹æ¶çš„è¯æˆ‘ä»¬è¿˜æ˜¯éœ€è¦äº†è§£å…¶ä¸­çš„ä¸€äº›é…ç½®çš„åŸç†çš„ã€‚

æˆ‘ä»¬è¿™ä¸€æ¬¡å®æˆ˜demoçš„éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼š

- jsæ¡†æ¶ï¼ˆvueã€typescriptã€tsxã€jsxï¼‰
- cssæ ·å¼ï¼ˆsassï¼‰
- å·¥ç¨‹åŒ–å·¥å…·ï¼ˆeslintã€babelã€webpackã€webpack-chainï¼‰

okï¼è¿™å·®ä¸å¤šç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„é¡¹ç›®äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥å®ç°ä¸€ä¸‹å®ƒã€‚

## å¼€å§‹

æˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªé¡¹ç›®å«[webpack-vue-demo](https://github.com/913453448/webpack-vue-demo.git)ï¼Œç„¶åè¿›åˆ°é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œnpm initï¼š

```bash
webpack-vue-demo npm init
	...
Is this OK? (yes) 
âœ  webpack-vue-demo 

```

### webpackè„šæ‰‹æ¶

åˆ›å»ºå®Œæ¯•åï¼Œæˆ‘ä»¬é¦–å…ˆå®‰è£…webpackç›¸å…³ä¾èµ–ï¼š

#### webpackï¼ˆwebpackæ¡†æ¶ï¼‰

```bash
yarn add -D webpack || npm install -D webpack
```

#### webpack-cliï¼ˆwebpackè„šæ‰‹æ¶ï¼‰

```bash
yarn add -D webpack-cli || npm install -D webpack-cli
```

#### webpack-dev-serverï¼ˆwebpackå¼€å‘ç¯å¢ƒï¼‰

```bash
yarn add -D webpack-dev-server || npm install -D webpack-dev-server
```

#### webpack-chainï¼ˆwebpacké“¾å¼é…ç½®ï¼‰

```bash
yarn add -D webpack-chain || npm install -D webpack-chain
```

ok! webpackè„šæ‰‹æ¶ç›¸å…³çš„ä¾èµ–æˆ‘ä»¬ç®—æ˜¯å®‰è£…å®Œäº†ï¼Œç„¶åæˆ‘ä»¬åœ¨å·¥ç¨‹æ ¹ç›®å½•åº•ä¸‹åˆ›å»ºä¸€ä¸ªwebpacké…ç½®æ–‡ä»¶`webpack.config.js`ï¼Œç”¨`webpack-chain`å¯¼å‡ºä¸€ä¸ªé…ç½®ï¼š

```js
const config = new (require("webpack-chain"))();
module.exports = config.toConfig();
```

ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨æ ¹ç›®å½•æ‰§è¡Œ`npx webpack`è·Ÿ`npx webpack-dev-server`å‘½ä»¤äº†ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨`package.json`ä¸­å£°æ˜ä¸¤ä¸ªè„šæœ¬`build`è·Ÿ`dev`,

```json
{
  "name": "webpack-vue-demo",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "build": "rimraf dist && webpack --mode=production",
    "dev": "webpack-dev-server --mode=development --progress"
  },
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "webpack": "^4.44.0",
    "webpack-chain": "^6.5.1",
    "webpack-cli": "^3.3.12",
    "webpack-dev-server": "^3.11.0"
  }
}
```

æˆ‘ä»¬è¯•ç€è¿è¡Œä¸€ä¸‹`build`å‘½ä»¤ï¼š

```bash
> webpack-vue-demo@1.0.0 build xx/webpack/webpack-vue-demo
> rimraf dist && webpack --mode=production


Insufficient number of arguments or no entry found.
Alternatively, run 'webpack(-cli) --help' for usage info.

Hash: a8dc1c75fbec1af4c624
Version: webpack 4.44.0
Time: 29ms
Built at: 07/27/2020 4:45:12 PM

ERROR in Entry module not found: Error: Can't resolve './src' in 'xxx/webpack/webpack-vue-demo'
npm ERR! code ELIFECYCLE
npm ERR! errno 2
npm ERR! webpack-vue-demo@1.0.0 build: `rimraf dist && webpack --mode=production`
npm ERR! Exit status 2
npm ERR! 
npm ERR! Failed at the webpack-vue-demo@1.0.0 build script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.
âœ  webpack-vue-demo git:(master) âœ— 

```

å¯ä»¥çœ‹åˆ°ï¼Œ`webpack`ç›´æ¥æŠ¥é”™äº†ï½ okï¼ åŸå› æˆ‘å°±ä¸è§£é‡Šäº†ï¼Œæ²¡çœ‹è¿‡å‰é¢æ–‡ç« çš„ç«¥é‹å¼ºçƒˆå»ºè®®å…ˆçœ‹å®Œå†è¿‡æ¥å®æˆ˜ã€‚

### typescript

å› ä¸ºæˆ‘ä»¬éœ€æ±‚ä¸­éœ€è¦æ”¯æŒtsï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­å®‰è£…tsç›¸å…³ä¾èµ–ï¼š

typescriptï¼ˆtsè„šæ‰‹æ¶ï¼‰

```bash
yarn add -D typescript || npm install -D typescript
```

ts-loaderï¼ˆtsåŠ è½½å™¨ï¼‰

```bash
yarn add -D ts-loader || npm install -D ts-loader
```

ok! tsç›¸å…³ä¾èµ–å®‰è£…å®Œæ¯•åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹åˆ›å»ºæˆ‘ä»¬é¡¹ç›®çš„ç›®å½•äº†ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨æ ¹ç›®å½•åº•ä¸‹åˆ›å»ºä¸€ä¸ªsrcç›®å½•ï¼Œç„¶ååœ¨srcç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª`main.ts`ç©ºæ–‡ä»¶å½“æˆé¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼š

```bash
webpack-vue-demo
	node_modules
	src
		main.ts
	.gitignore
	package.json
	README.md
	webpack.config.js
```

ç„¶åæˆ‘ä»¬å»ä¿®æ”¹ä¸€ä¸‹webpackçš„é…ç½®ã€‚

### å…¥å£é…ç½®

webpack.config.js:

```js
const path = require("path");
const config = new (require("webpack-chain"))();
config
    .context(path.resolve(__dirname, ".")) //webpackä¸Šä¸‹æ–‡ç›®å½•ä¸ºé¡¹ç›®æ ¹ç›®å½•
    .entry("app") //å…¥å£æ–‡ä»¶åç§°ä¸ºapp
        .add("./src/main.ts") //å…¥å£æ–‡ä»¶ä¸º./src/main.ts
        .end()
    .output
        .path(path.join(__dirname,"./dist")) //webpackè¾“å‡ºçš„ç›®å½•ä¸ºæ ¹ç›®å½•çš„distç›®å½•
        .filename( "[name].[contenthash:8].js") //æ‰“åŒ…å‡ºæ¥çš„bundleåç§°ä¸º[name].[contenthash:8].js
        .publicPath("./") //publicpathé…ç½®ä¸º"./"
    .end()

module.exports = config.toConfig();
```

æˆ‘ä»¬å†æ¬¡æ‰§è¡Œ`npm run build`ï¼š

```bash
âœ  webpack-vue-demo git:(master) âœ— npm run build

> webpack-vue-demo@1.0.0 build xxx/webpack/webpack-vue-demo
> rimraf dist && webpack --mode=production

Hash: f102af84da880d301fb5
Version: webpack 4.44.0
Time: 198ms
Built at: 07/27/2020 5:05:26 PM
          Asset       Size  Chunks                         Chunk Names
app.995b67bc.js  964 bytes       0  [emitted] [immutable]  app
Entrypoint app = app.995b67bc.js
[0] multi ./src/main.ts 28 bytes {0} [built]
[1] ./src/main.ts 0 bytes {0} [built]
âœ  webpack-vue-demo git:(master) âœ— 

```

okï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œwebpacké€šè¿‡æˆ‘ä»¬é…ç½®çš„å…¥å£æ–‡ä»¶main.tsæ–‡ä»¶æ‰“åŒ…å‡ºæ¥äº†ä¸€ä¸ªå«app.995b67bc.jsçš„æ–‡ä»¶ï¼Œ

dist/app.995b67bc.js:

```js
!function (e) {
    var t = {};

    function n(r) {
        if (t[r]) return t[r].exports;
        var o = t[r] = {i: r, l: !1, exports: {}};
        return e[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports
    }

    n.m = e, n.c = t, n.d = function (e, t, r) {
        n.o(e, t) || Object.defineProperty(e, t, {enumerable: !0, get: r})
    }, n.r = function (e) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {value: "Module"}), Object.defineProperty(e, "__esModule", {value: !0})
    }, n.t = function (e, t) {
        if (1 & t && (e = n(e)), 8 & t) return e;
        if (4 & t && "object" == typeof e && e && e.__esModule) return e;
        var r = Object.create(null);
        if (n.r(r), Object.defineProperty(r, "default", {
            enumerable: !0,
            value: e
        }), 2 & t && "string" != typeof e) for (var o in e) n.d(r, o, function (t) {
            return e[t]
        }.bind(null, o));
        return r
    }, n.n = function (e) {
        var t = e && e.__esModule ? function () {
            return e.default
        } : function () {
            return e
        };
        return n.d(t, "a", t), t
    }, n.o = function (e, t) {
        return Object.prototype.hasOwnProperty.call(e, t)
    }, n.p = "./", n(n.s = 0)
}([function (e, t, n) {
    e.exports = n(1)
}, function (e, t) {
}]);
```

å“ˆå“ˆï¼Œä¼°è®¡ä½ æ˜¯çœ‹ä¸æ‡‚çš„ï¼ å› ä¸ºæˆ‘ä»¬çš„main.tsæ˜¯ä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œæ‰€ä»¥æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åªä¼šåŒ…å«ä¸€äº›webpackçš„runtimeä»£ç ã€‚

æˆ‘ä»¬è¯•ç€å»`main.ts`æ–‡ä»¶ä¸­å†™ç‚¹tsä»£ç ï¼Œ

src/main.tsï¼š

```js
let a:string="hello";
```

æˆ‘ä»¬å†æ¬¡è¿è¡Œ`npm run build`ï¼š

```bash
âœ  webpack-vue-demo git:(master) âœ— npm run build

...
ERROR in ./src/main.ts 1:5
Module parse failed: Unexpected token (1:5)
You may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders
> let a:string="hello";
 @ multi ./src/main.ts app[0]
npm ERR! code ELIFECYCLE
npm ERR! errno 2
npm ERR! webpack-vue-demo@1.0.0 build: `rimraf dist && webpack --mode=production`
npm ERR! Exit status 2
npm ERR! 
npm ERR! Failed at the webpack-vue-demo@1.0.0 build script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.
âœ  webpack-vue-demo git:(master) âœ— 

```

å¯ä»¥çœ‹åˆ°ï¼Œwebpackç›´æ¥æŠ¥é”™äº†ï¼Œå› ä¸ºwebpacké»˜è®¤çš„loaderåªèƒ½åŠ è½½jsè·Ÿjsonè¯­æ³•ï¼Œä¸èƒ½è¯†åˆ«æˆ‘ä»¬çš„tsè¯­æ³•ï¼Œæ‰€ä»¥webpackå»ºè®®æˆ‘ä»¬é…ç½®`.ts`ç»“å°¾æ–‡ä»¶çš„loaderã€‚

### é…ç½®ts-loader

webpack.config.js:

```js
const path = require("path");
const config = new (require("webpack-chain"))();
config
    .context(path.resolve(__dirname, ".")) //webpackä¸Šä¸‹æ–‡ç›®å½•ä¸ºé¡¹ç›®æ ¹ç›®å½•
    .entry("app") //å…¥å£æ–‡ä»¶åç§°ä¸ºapp
        .add("./src/main.ts") //å…¥å£æ–‡ä»¶ä¸º./src/main.ts
        .end()
    .output
        .path(path.join(__dirname,"./dist")) //webpackè¾“å‡ºçš„ç›®å½•ä¸ºæ ¹ç›®å½•çš„distç›®å½•
        .filename( "[name].[contenthash:8].js") //æ‰“åŒ…å‡ºæ¥çš„bundleåç§°ä¸º[name].[contenthash:8].js
        .publicPath("./") //publicpathé…ç½®ä¸º"./"
        .end()
    .resolve
        .extensions
            .add(".js").add(".jsx").add(".ts").add(".tsx").add(".vue") //é…ç½®ä»¥.jsç­‰ç»“å°¾çš„æ–‡ä»¶å½“æ¨¡å—ä½¿ç”¨çš„æ—¶å€™éƒ½å¯ä»¥çœç•¥åç¼€
            .end()
        .end()
    .module
        .rule("type-script")
            .test(/\.tsx?$/) //loaderåŠ è½½çš„æ¡ä»¶æ˜¯tsæˆ–tsxåç¼€çš„æ–‡ä»¶
            .use("ts-loader")
                .loader("ts-loader")
                .options({ //ts-loaderç›¸å…³é…ç½®
                    transpileOnly: true,
                    appendTsSuffixTo: ['\\.vue$']
                })
                .end()
            .end()
module.exports = config.toConfig();
```

ç„¶ååœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªtsçš„é…ç½®æ–‡ä»¶tsconfig.jsonï¼š

```json
{
  "compilerOptions": {
    "target": "esnext",
    "module": "esnext",
    "strict": true,
    "jsx": "preserve",
    "importHelpers": true,
    "moduleResolution": "node",
    "experimentalDecorators": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "suppressImplicitAnyIndexErrors": true,
    "resolveJsonModule": true,
    "sourceMap": true,
    "baseUrl": ".",
    "types": [
      "webpack-env"
    ],
    "paths": {
      "@/*": [
        "src/*"
      ]
    },
    "lib": [
      "esnext",
      "dom",
      "dom.iterable",
      "scripthost"
    ]
  },
  "include": [
    "src/**/*.ts",
    "src/**/*.tsx",
    "src/**/*.vue",
  ],
  "exclude": [
    "node_modules"
  ]
}

```

okï¼Œç„¶åæˆ‘ä»¬å†æ¬¡è¿è¡Œ`npm run build`å‘½ä»¤ï¼š

```bash
âœ  webpack-vue-demo git:(master) âœ— npm run build

> webpack-vue-demo@1.0.0 build xxx/webpack-vue-demo
> rimraf dist && webpack --mode=production

Hash: f5bd51439408213acbe2
Version: webpack 4.44.0
Time: 403ms
Built at: 07/27/2020 5:21:40 PM
          Asset       Size  Chunks                         Chunk Names
app.b894f269.js  999 bytes       0  [emitted] [immutable]  app
Entrypoint app = app.b894f269.js
[0] multi ./src/main.ts 28 bytes {0} [built]
[1] ./src/main.ts 47 bytes {0} [built]
âœ  webpack-vue-demo git:(master) âœ— 

```

å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡å°±æ²¡æœ‰æŠ¥é”™äº†ï¼Œå› ä¸ºæˆ‘ä»¬çš„webpackå¯ä»¥é€šè¿‡æˆ‘ä»¬å®šä¹‰çš„ts-loaderè¯†åˆ«æˆ‘ä»¬çš„tsè¯­æ³•äº†ï¼Œæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹å§ï¼Œæˆ‘ä»¬ä¿®æ”¹main.tsæ–‡ä»¶ï¼š

```typescript
let a:string="hello";
console.log(a)
```

ä»£ç å¾ˆç®€å•ï¼Œç„¶åæˆ‘ä»¬æ‰§è¡Œ"npm run build"çœ‹æœ€åæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶ï¼š

dist/app.b894f269.js

```js
!function (e) {
    var t = {};

   ...
}([function (e, t, n) {
    e.exports = n(1)
}, function (e, t, n) {
    "use strict";
    console.log("hello") //webpackæ‰“åŒ…è¿‡åçš„ä»£ç 
}]);
```

### vueé…ç½®

#### vue

```bash
yarn add vue || npm install -S vue
```

#### vue-loaderï¼ˆvueåŠ è½½å™¨ï¼‰

```bash
yarn add -D vue-loader || npm install -D vue-loader
```

#### vue-template-compilerï¼ˆ.vueæ–‡ä»¶æ¨¡ç‰ˆç¼–è¯‘å™¨ï¼‰

```bash
yarn add -D vue-template-compiler || npm install -D vue-template-compiler
```

#### vue-class-componentï¼ˆvueç±»ç»„ä»¶ï¼‰

```bash
yarn add  vue-class-component || npm install -S vue-class-component
```

#### vue-property-decoratorï¼ˆvueå±æ€§è£…é¥°å™¨ï¼‰

```bash
yarn add  vue-property-decorator || npm install vue-property-decorator
```

ok, ç„¶åæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼Œè®©webpackæ”¯æŒ.vueæ–‡ä»¶è§£æï¼Œ

webpack.config.jsï¼š

```js
const path = require("path");
const config = new (require("webpack-chain"))();
config
    .context(path.resolve(__dirname, ".")) //webpackä¸Šä¸‹æ–‡ç›®å½•ä¸ºé¡¹ç›®æ ¹ç›®å½•
    .entry("app") //å…¥å£æ–‡ä»¶åç§°ä¸ºapp
        .add("./src/main.ts") //å…¥å£æ–‡ä»¶ä¸º./src/main.ts
        .end()
    .output
        .path(path.join(__dirname,"./dist")) //webpackè¾“å‡ºçš„ç›®å½•ä¸ºæ ¹ç›®å½•çš„distç›®å½•
        .filename("[name].[hash:8].js")
        .end()
    .resolve
        .extensions
            .add(".js").add(".jsx").add(".ts").add(".tsx").add(".vue") //é…ç½®ä»¥.jsç­‰ç»“å°¾çš„æ–‡ä»¶å½“æ¨¡å—ä½¿ç”¨çš„æ—¶å€™éƒ½å¯ä»¥çœç•¥åç¼€
            .end()
        .end()
    .module
        .rule("type-script")
            .test(/\.tsx?$/) //loaderåŠ è½½çš„æ¡ä»¶æ˜¯tsæˆ–tsxåç¼€çš„æ–‡ä»¶
            .use("ts-loader")
                .loader("ts-loader")
                .options({ //ts-loaderç›¸å…³é…ç½®
                    transpileOnly: true,
                    appendTsSuffixTo: ['\\.vue$']
                })
                .end()
            .end()
        .rule("vue")
            .test(/\.vue$/)// åŒ¹é….vueæ–‡ä»¶
                .use("vue-loader")
                .loader("vue-loader")
                .end()
            .end()
        .end()
    .plugin("vue-loader-plugin")//vue-loaderå¿…é¡»è¦æ·»åŠ vue-loader-plugin
        .use(require("vue-loader").VueLoaderPlugin,[])
        .end()
    .devServer
        .host("0.0.0.0") //ä¸ºäº†è®©å¤–éƒ¨æœåŠ¡è®¿é—®
        .port(8090) //å½“å‰ç«¯å£å·
        .hot(true) //çƒ­è½½
        .open(true) //å¼€å¯é¡µé¢
module.exports = config.toConfig();
```

ç„¶åæˆ‘ä»¬å»srcç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªapp.vueæ–‡ä»¶ç”¨æ¥æµ‹è¯•ï¼Œ

src/app.vue:

```vue
<template>
    <div>{{this.msg}}</div>
</template>

<script lang="ts">
  import {Vue, Component} from "vue-property-decorator";

  @Component
  export default class App extends Vue {
    msg="hello world"
  }
</script>

<style scoped>

</style>
```

å¾ˆç®€å•ï¼Œå°±æ˜¯è¾“å‡ºä¸€ä¸ª"hello world"åˆ°é¡µé¢ï¼Œç„¶åæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹â€œmain.tsâ€æ–‡ä»¶ï¼Œ

src/main.ts:

```tsx
import Vue from "vue";
import App from "./app.vue";

new Vue({
  el: "#app",
  render: (h) => h(App)
});
```

ok! æˆ‘ä»¬ç›´æ¥è¿è¡Œä¸€ä¸‹`npm run dev`:

```bash
192:webpack-vue-demo yinqingyang$ npm run dev

> webpack-vue-demo@1.0.0 dev xxx/webpack-vue-demo
> webpack-dev-server --mode=development --progress

10% building 2/2 modules 0 activeâ„¹ ï½¢wdsï½£: Project is running at http://0.0.0.0:8090/
â„¹ ï½¢wdsï½£: webpack output is served from /
â„¹ ï½¢wdsï½£: Content not from webpack is served from xxx/xxx/webpack-vue-demo
10% building 5/15 modules 10 activexxx/webpack-vue-demo/node_modules/webpack-dev-server/client/utils/createSocketUrâ„¹ ï½¢wdmï½£: wait until bundle finished: /
â„¹ ï½¢wdmï½£: Hash: 6b8de437340cfe2ceccd
Version: webpack 4.44.0
Time: 2431ms
Built at: 07/27/2020 8:57:11 PM
          Asset     Size  Chunks                         Chunk Names
app.6b8de437.js  697 KiB     app  [emitted] [immutable]  app
Entrypoint app = app.6b8de437.js
...
[./src/main.ts] 108 bytes {app} [built]
    + 35 hidden modules
â„¹ ï½¢wdmï½£: Compiled successfully.


```

å¯ä»¥çœ‹åˆ°ï¼Œwebpack-dev-serveræœåŠ¡å·²ç»å¼€å¯äº†ï¼Œå¹¶ä¸”æœåŠ¡å™¨åœ¨8090ç«¯å£ç›‘å¬ï¼Œæˆ‘ä»¬ç›´æ¥æµè§ˆå™¨æ‰“å¼€é“¾æ¥ï¼šhttp://0.0.0.0:8090/webpack-dev-serverï¼š

![webpack-dev-s](/Users/yinqingyang/å‰ç«¯æ¶æ„ç³»åˆ—ä¹‹(webpack)/webpack-vue-demo/webpack-dev-s.png)

webpack-dev-serverä¼šæŠŠæ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶åˆ—åœ¨è¿™é‡Œï¼Œâ€œapp.6b8de437.jsâ€å°±æ˜¯webpackæ ¹æ®å…¥å£main.tsæ–‡ä»¶ç”Ÿæˆçš„bundleæ–‡ä»¶ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªpublicç›®å½•ï¼Œç„¶ååœ¨publicç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªå«index.htmlçš„æ–‡ä»¶ç”¨æ¥æµ‹è¯•ï¼Œ

public/index.html:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<noscript>your browser should support javascript!</noscript>
<div id="app"></div>
<script src="http://0.0.0.0:8090/app.6b8de437.js"></script>
</body>
</html>
```

okï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç›´æ¥æ”¾äº†ä¸€ä¸ªdivå…ƒç´ ä¾›main.tsä¸­çš„vueå®ä¾‹æŒ‚è½½ï¼Œç„¶åå°±æ˜¯ç›´æ¥ä¸€ä¸ªscriptæ ‡ç­¾åŠ è½½å…¥å£æ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠindex.htmlæ–‡ä»¶åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š

![result1](/Users/yinqingyang/å‰ç«¯æ¶æ„ç³»åˆ—ä¹‹(webpack)/webpack-vue-demo/result1.png)

å¯ä»¥çœ‹åˆ°ï¼Œæµè§ˆå™¨ä¸­æ˜¾ç¤ºäº†æˆ‘ä»¬çš„é¢„æœŸç»“æœï¼ ä½†æ˜¯æˆ‘ä»¬æ˜¯æ‰‹åŠ¨çš„å»å¼•å…¥â€œapp.6b8de437.jsâ€æ–‡ä»¶çš„ï¼Œè¿™éš¾å…æœ‰ç‚¹ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬è®©å®ƒè‡ªåŠ¨å¯¼å…¥bundleæ–‡ä»¶åˆ°æ¨¡ç‰ˆhtmlæ–‡ä»¶ä¸­ã€‚

### html-webpack-plugin

æˆ‘ä»¬é¦–å…ˆå®‰è£…html-webpack-pluginï¼š

```bash
yarn add -D html-webpack-plugin || npm install -D html-webpack-plugin
```

ç„¶åä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶æ·»åŠ html-webpack-pluginæ’ä»¶ï¼Œ

webpack.config.jsï¼š

```js
const path = require("path");
const config = new (require("webpack-chain"))();
config
    .context(path.resolve(__dirname, ".")) //webpackä¸Šä¸‹æ–‡ç›®å½•ä¸ºé¡¹ç›®æ ¹ç›®å½•
    .entry("app") //å…¥å£æ–‡ä»¶åç§°ä¸ºapp
        .add("./src/main.ts") //å…¥å£æ–‡ä»¶ä¸º./src/main.ts
        .end()
    .output
        .path(path.join(__dirname,"./dist")) //webpackè¾“å‡ºçš„ç›®å½•ä¸ºæ ¹ç›®å½•çš„distç›®å½•
        .filename("[name].[hash:8].js")
        .end()
    .resolve
        .extensions
            .add(".js").add(".jsx").add(".ts").add(".tsx").add(".vue") //é…ç½®ä»¥.jsç­‰ç»“å°¾çš„æ–‡ä»¶å½“æ¨¡å—ä½¿ç”¨çš„æ—¶å€™éƒ½å¯ä»¥çœç•¥åç¼€
            .end()
        .end()
    .module
        .rule("type-script")
            .test(/\.tsx?$/) //loaderåŠ è½½çš„æ¡ä»¶æ˜¯tsæˆ–tsxåç¼€çš„æ–‡ä»¶
            .use("ts-loader")
                .loader("ts-loader")
                .options({ //ts-loaderç›¸å…³é…ç½®
                    transpileOnly: true,
                    appendTsSuffixTo: ['\\.vue$']
                })
                .end()
            .end()
        .rule("vue")
            .test(/\.vue$/)// åŒ¹é….vueæ–‡ä»¶
                .use("vue-loader")
                .loader("vue-loader")
                .end()
            .end()
        .end()
    .plugin("vue-loader-plugin")//vue-loaderå¿…é¡»è¦æ·»åŠ vue-loader-plugin
        .use(require("vue-loader").VueLoaderPlugin,[])
        .end()
    .plugin("html")// æ·»åŠ html-webpack-pluginæ’ä»¶
        .use(require("html-webpack-plugin"),[{
            template: path.resolve(__dirname,"./public/index.html"), //æŒ‡å®šæ¨¡ç‰ˆæ–‡ä»¶
            chunks:["app"], //æŒ‡å®šéœ€è¦åŠ è½½çš„chunk
            inject: "body" //æŒ‡å®šscriptè„šæœ¬æ³¨å…¥çš„ä½ç½®ä¸ºbody
        }])
        .end()
    .devServer
        .host("0.0.0.0") //ä¸ºäº†è®©å¤–éƒ¨æœåŠ¡è®¿é—®
        .port(8090) //å½“å‰ç«¯å£å·
        .hot(true) //çƒ­è½½
        .open(true) //å¼€å¯é¡µé¢
module.exports = config.toConfig();
```

okï¼Œç„¶åæˆ‘ä»¬ç›´æ¥`npm run dev`:

```bash
npm run dev
```

è¿è¡Œåä¼šå‘ç°æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€äº†http://0.0.0.0:8090/é¡µé¢ï¼š

![result2](/Users/yinqingyang/å‰ç«¯æ¶æ„ç³»åˆ—ä¹‹(webpack)/webpack-vue-demo/result2.png)

è™½ç„¶æ˜¯è¿è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯ideä¸€ç›´åœ¨æç¤ºæœ‰ä¸ªåœ°æ–¹æŠ¥é”™ï¼š

![no-declarations](/Users/yinqingyang/å‰ç«¯æ¶æ„ç³»åˆ—ä¹‹(webpack)/webpack-vue-demo/no-declarations.png)

æ„æ€å°±æ˜¯ï¼šâ€œå¯¼å…¥çš„app.vueå¹¶æ²¡æœ‰ç±»å‹å£°æ˜æ–‡ä»¶â€ï¼Œokï¼Œæˆ‘ä»¬ç›´æ¥åœ¨srcç›®å½•åº•ä¸‹åˆ›å»ºä¸€ä¸ªshims-vue.d.tsæ–‡ä»¶ç”¨æ¥å£°æ˜.vue æ–‡ä»¶å¯¼å‡ºçš„ç±»å‹ï¼Œ

src/shims-vue.d.tsï¼š

```ts
declare module "*.vue" {
  import Vue from "vue";
  export default Vue;
}

```

æˆ‘ä»¬ç›´æ¥å£°æ˜äº†ä¸€ä¸ªmodule,ç„¶åå¯¼å‡ºä¸€ä¸ªvueå®ä¾‹ï¼Œå£°æ˜ä¹‹åå°±ä¼šå‘ç°ideæŠ¥é”™æ²¡æœ‰äº†ã€‚

### cssæ ·å¼ï¼ˆscssï¼‰

æˆ‘ä»¬è¯•ç€åœ¨vueæ¨¡ç‰ˆä¸­ä½¿ç”¨ä¸€ä¸‹sassè¯­æ³•ï¼š

src/app.vue

```vue
<template>
    <div class="app-container">{{this.msg}}</div>
</template>

<script lang="ts">
  import {Vue, Component} from "vue-property-decorator";

  @Component
  export default class App extends Vue {
    msg="hello world"
  }
</script>

<style scoped lang="scss">
.app-container{
    color: red;
}
</style>
```

```bash
...
File was processed with these loaders:
 * ./node_modules/vue-loader/lib/index.js
You may need an additional loader to handle the result of these loaders.
| 
| 
> .app-container{
|     color: red;
| }
 @ ./src/app.vue?vue&type=style&index=0&id=5ef48958&scoped=true&lang=scss& 1:0-148 1:164-167 1:169-314 1:169-314
 @ ./src/app.vue
 @ ./src/main.ts
 @ multi ./src/main.ts
â„¹ ï½¢wdmï½£: Failed to compile.
```

ok, å¼€å¯webpackæœåŠ¡åä¼šå‘ç°æŠ¥é”™äº†ï¼šâ€œæ‰¾ä¸åˆ°èƒ½å¤Ÿè§£æå½“å‰æ ·å¼è¯­æ³•çš„loaderâ€ï¼Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±è®©webpackæ”¯æŒscssè¯­æ³•ã€‚

#### sassï¼ˆscss&&sassè¯­æ³•ï¼‰

```bash
yarn add -D sass || npm install -D sass
```

#### sass-loaderï¼ˆsass&&scssæ–‡ä»¶åŠ è½½å™¨ï¼‰

```bash
yarn add -D sass-loader || npm install -D sass-loader
```

#### postcss-loader(cssæ ·å¼å¤„ç†å·¥å…·)

æ¯”å¦‚ï¼šè‡ªåŠ¨æ·»åŠ æµè§ˆå™¨é€‚é…å‰ç¼€ã€å‹ç¼©cssæ ·å¼ç­‰ç­‰

```bash
yarn add -D postcss-loader || npm install -D postcss-loader
```

##### cssnano(å‹ç¼©css)

```bash
yarn add -D cssnano || npm install -D cssnano
```

##### autoprefixer(è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨é€‚é…å‰ç¼€)

```bash
yarn add -D autoprefixer || npm install -D autoprefixer
```

#### css-loader(cssæ¨¡å—åŠ è½½å™¨)

```bash
yarn add -D css-loader || npm install -D css-loader
```

#### mini-css-extract-plugin(æŠ½ç¦»cssæ ·å¼åˆ°ç‹¬ç«‹çš„.cssæ–‡ä»¶)

```bash
yarn add -D mini-css-extract-plugin || npm install -D mini-css-extract-plugin
```

ç„¶åä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œwebpack.config.jsï¼š

```js
const path = require("path");
const config = new (require("webpack-chain"))();
const isDev = process.env.WEBPACK_DEV_SERVER;
config
    .context(path.resolve(__dirname, ".")) //webpackä¸Šä¸‹æ–‡ç›®å½•ä¸ºé¡¹ç›®æ ¹ç›®å½•
    .entry("app") //å…¥å£æ–‡ä»¶åç§°ä¸ºapp
        .add("./src/main.ts") //å…¥å£æ–‡ä»¶ä¸º./src/main.ts
        .end()
    .output
        .path(path.join(__dirname,"./dist")) //webpackè¾“å‡ºçš„ç›®å½•ä¸ºæ ¹ç›®å½•çš„distç›®å½•
        .filename("[name].[hash:8].js")
        .end()
    .resolve
        .extensions
            .add(".js").add(".jsx").add(".ts").add(".tsx").add(".vue") //é…ç½®ä»¥.jsç­‰ç»“å°¾çš„æ–‡ä»¶å½“æ¨¡å—ä½¿ç”¨çš„æ—¶å€™éƒ½å¯ä»¥çœç•¥åç¼€
            .end()
        .end()
    .module
        .rule("type-script")
            .test(/\.tsx?$/) //loaderåŠ è½½çš„æ¡ä»¶æ˜¯tsæˆ–tsxåç¼€çš„æ–‡ä»¶
            .use("ts-loader")
                .loader("ts-loader")
                .options({ //ts-loaderç›¸å…³é…ç½®
                    transpileOnly: true,
                    appendTsSuffixTo: ['\\.vue$']
                })
                .end()
            .end()
        .rule("vue")
            .test(/\.vue$/)// åŒ¹é….vueæ–‡ä»¶
                .use("vue-loader")
                .loader("vue-loader")
                .end()
            .end()
        .rule("sass")
            .test( /\.(sass|scss)$/)//sasså’Œscssæ–‡ä»¶
            .use("extract-loader")//æå–cssæ ·å¼åˆ°å•ç‹¬cssæ–‡ä»¶
                .loader(require('mini-css-extract-plugin').loader)
                .options({
                    hmr: isDev //å¼€å‘ç¯å¢ƒå¼€å¯çƒ­è½½
                })
                .end()
            .use("css-loader")//åŠ è½½cssæ¨¡å—
                .loader("css-loader")
                .end()
            .use("postcss-loader")//å¤„ç†cssæ ·å¼
                .loader("postcss-loader")
                .options( {
                    config: {
                       path: path.resolve(__dirname, "./postcss.config.js")
                    }
                })
                .end()
            .use("sass-loader")//sassè¯­æ³•è½¬cssè¯­æ³•
                .loader("sass-loader")
                .end()
            .end()
        .end()
    .plugin("vue-loader-plugin")//vue-loaderå¿…é¡»è¦æ·»åŠ vue-loader-plugin
        .use(require("vue-loader").VueLoaderPlugin,[])
        .end()
    .plugin("html")// æ·»åŠ html-webpack-pluginæ’ä»¶
        .use(require("html-webpack-plugin"),[{
            template: path.resolve(__dirname,"./public/index.html"), //æŒ‡å®šæ¨¡ç‰ˆæ–‡ä»¶
            chunks:["app"], //æŒ‡å®šéœ€è¦åŠ è½½çš„chunk
            inject: "body" //æŒ‡å®šscriptè„šæœ¬æ³¨å…¥çš„ä½ç½®ä¸ºbody
        }])
        .end()
    .plugin("extract-css")//æå–cssæ ·å¼åˆ°å•ç‹¬cssæ–‡ä»¶
        .use(require('mini-css-extract-plugin'), [{
            filename: "css/[name].css",
            chunkFilename: "css/[name].css"
        }])
        .end()
    .devServer
        .host("0.0.0.0") //ä¸ºäº†è®©å¤–éƒ¨æœåŠ¡è®¿é—®
        .port(8090) //å½“å‰ç«¯å£å·
        .hot(true) //çƒ­è½½
        .open(true) //å¼€å¯é¡µé¢
module.exports = config.toConfig();
```

ç„¶åæˆ‘ä»¬ç»™postcssæŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬åœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªpostcss.config.jsï¼š

```js
module.exports = {
    plugins: [
        require("autoprefixer")(),
        require("cssnano")({
            preset: ['default', {
                mergeLonghand: false,
                cssDeclarationSorter: false
            }]
        })
    ]
};
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åŠ å…¥äº†â€œautoprefixerâ€è·Ÿâ€œcssnanoâ€æ’ä»¶ç”¨äºè‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€è·Ÿcsså‹ç¼©ï¼Œç„¶åæˆ‘ä»¬åœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª.browserslistrcç”¨äºå½“å‰é¡¹ç›®æµè§ˆå™¨åˆ—è¡¨ï¼Œ

.browserslistrcï¼š

```js
> 0.25%, not dead
```

cssæ ·å¼ç›¸å…³çš„é…ç½®æˆ‘è¿™é‡Œå°±ä¸è¯¦ç»†è¯´æ˜äº†ï¼Œä¸æ‡‚çš„å°ä¼™ä¼´å¯ä»¥çœ‹å‰é¢çš„æ–‡ç« ï¼Œé…ç½®å®Œcssåæˆ‘ä»¬å†çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„app.vueæ–‡ä»¶ï¼Œ

src/app.vue:

```vue
<template>
    <div class="app-container">{{this.msg}}</div>
</template>

<script lang="ts">
  import {Vue, Component} from "vue-property-decorator";

  @Component
  export default class App extends Vue {
    msg="hello world"
  }
</script>

<style scoped lang="scss">
.app-container{
    color: green;
}
</style>
```

ğŸ‘Œï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç»™äº†å½“å‰divä¸€ä¸ªæ ·å¼ï¼š

```css
.app-container{
    color: green;
}
```

ç„¶åæˆ‘ä»¬è¿è¡Œ`npm run dev`æŒ‡ä»¤ï¼š

```bash
npm run dev
```

![css-green](/Users/yinqingyang/å‰ç«¯æ¶æ„ç³»åˆ—ä¹‹(webpack)/webpack-vue-demo/css-green.png)

ok, ç„¶åæˆ‘ä»¬ä¿®æ”¹æˆä¸ºçº¢è‰²è¯•è¯•ï¼Œsrc/app.vue:

```vue
<template>
    <div class="app-container">{{this.msg}}</div>
</template>

<script lang="ts">
  import {Vue, Component} from "vue-property-decorator";

  @Component
  export default class App extends Vue {
    msg="hello world"
  }
</script>

<style scoped lang="scss">
.app-container{
    color: red;
}
</style>
```

![css-red](/Users/yinqingyang/å‰ç«¯æ¶æ„ç³»åˆ—ä¹‹(webpack)/webpack-vue-demo/css-red.png)

å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº†æ ·å¼åï¼Œmini-css-extract-pluginè§¦å‘äº†çƒ­è½½ï¼Œé¡µé¢æ ·å¼è‡ªåŠ¨æ›´æ–°ã€‚

ok! è¿™ä¸€èŠ‚å…ˆåˆ°è¿™é‡Œäº†ï¼Œå› ä¸ºæ‰›ä¸ä½äº†è¦ç¡è§‰äº†ğŸ˜‚ï½  ä¸‹èŠ‚ç»§ç»­ï½æ•¬è¯·æœŸå¾…ï¼ï¼ï¼

